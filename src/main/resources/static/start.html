<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Start Asset</title>
	<link rel="stylesheet" type="text/css" href="./css/libs/jquery-ui.css"		/>
	<link rel="stylesheet" type="text/css" href="./css/highchart.css"			/>
	<link rel="stylesheet" type="text/css" href="./css/layout.css"				/>
	<link rel="stylesheet" type="text/css" href="./css/common.css"				/>
	<script type="text/javascript" src="./js/libs/jquery-1.12.4.min.js"			></script>
	<script type="text/javascript" src="./js/libs/jquery-ui.js"					></script>
 	<script type="text/javascript" src="./js/libs/highcharts.js"				></script>
	<script type="text/javascript" src="./js/libs/highcharts-more.js"			></script>
	<script type="text/javascript" src="./js/libs/highcharts-treemap.js"		></script>
	<script type="text/javascript" src="./js/libs/highcharts-heatmap.js"		></script>
	<script type="text/javascript" src="./js/libs/highcharts-accessibility.js"	></script>
	<script type="text/javascript" src="./js/libs/index.global.js"				></script>
	<script type="text/javascript" src="./js/common.js"							></script>

	<script type="text/javascript" 	src="./ui/js/lib/jsrender.js"				></script>
	<script type="text/javascript" 	src="./ui/js/common/config.js"				></script>
	<script type="text/javascript" 	src="./ui/js/common/function_ajax.js"		></script>
	<script type="text/javascript" 	src="./ui/js/common/function_common.js"		></script>
	<script type="text/javascript" 	src="./ui/js/common/project_common.js"		></script>
    <script type="text/javascript" src="./ui/js/common.js" 						></script>
<!--     <script type="text/javascript" src="./ui/js/menu.js"   						></script>  -->
    <script type="text/javascript" src="./ui/js/excel.js"  						></script>
    <script type="text/javascript" src="./ui/js/chart.js"  						></script>
    <script type="text/javascript" src="./ui/js/lodash.js" 						></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
		
    <script type="text/javascript"    src="./js/ckeditor/build/ckeditor.js"       	></script>
    <script type="text/javascript"    src="./js/ckeditor/build/UploadAdapter.js"   ></script>
    
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"		></script>
    
	<script type="text/javascript">
		// Session설정
		
		var sendParm = {
			 targetUrl 	: _WEB_ROOT_URL + "/getSession.do"
			,data		: {}
		}
		
		let userInfo = ajaxRequest(sendParm);
		
		if(isEmpty(userInfo)) {
			C_POP.alert('Session정보가 없습니다. 로그인을 해주세요.');
			location.replace("/");
			
		} else {
			G_VAL.session			= userInfo				;

			G_VAL.session.spCstmId	= userInfo.SP_CSTM_ID 	;
			G_VAL.session.userId  	= userInfo.USER_ID 		;
			G_VAL.session.userNm  	= userInfo.USER_NM 		;
			G_VAL.session.grade		= userInfo.GRADE 		;
			G_VAL.session.email		= userInfo.E_MAIL 		;
		}
		
		
		$(function() {
			// 시작 Page Id
			C_MENU.initMenu();
			
			$("#loginUserNm").html(userInfo.USER_NM);
			
		});	
		
		var sessionInfo = {}
		
		function goPage(pageId, parameter) {
			
			C_PM.movePage(pageId.trim(), parameter);
		}
		
		var C_MENU = {
			 nowMainMenuIdx	: 0
			,nowSubMenuIdx	: 0
			,allMenuMap		: {}
			,mainMenuList	: []
			,subMenuListMap	: {}
			,subMenuList	: []
			,initMenu : function() {
				var parm = {
					 queryId 		: "system.getMenuList"
					,requestParm	: {}
				}	
				C_COM.requestQuery(parm, function(resultData) {
					let menuOrgList 	= resultData.data;
					let mainMenuList 	= []
					let subMenuAllList	= []
					let mainMenuIdx 	= -1;
					let subMenuIdx		= 0;
					$.each(menuOrgList, function() {
						C_MENU.allMenuMap[this.MENU_ID] = this;
						if(this.MENU_DEPTH == 0) {
							mainMenuIdx++;
							mainMenuList	.push(this);
							C_MENU.allMenuMap[this.MENU_ID].mainIndex = mainMenuIdx;
							subMenuIdx = 0;
						} else	{
							subMenuAllList	.push(this);
							C_MENU.allMenuMap[this.MENU_ID].mainIndex = mainMenuIdx;
							C_MENU.allMenuMap[this.MENU_ID].subIndex = subMenuIdx;
							subMenuIdx++;
						}
					});
					
					C_MENU.mainMenuList = mainMenuList;
					
					$.each(subMenuAllList, function() {
						if(isEmpty(C_MENU.subMenuListMap[this.PARENT_MENU_ID])) C_MENU.subMenuListMap[this.PARENT_MENU_ID] = [];
						C_MENU.subMenuListMap[this.PARENT_MENU_ID].push(this);	
					});
					setTimeout(function() {
						C_MENU.moveMenu("MN_DSH_FA");	
					}, 1000);
					
				});
			 }
			,setMenuActive : function(menuList, idx) {
				$.each(menuList, function(i) {
					menuList[i].activeClass = "";
				});
				menuList[idx].activeClass = "active";
			 }
			,showMainMenuList : function(idx) {
				// 현재 선택된 Main Idx 저장
				C_MENU.nowMainMenuIdx = idx;
				// 현재 선택된 Main Menu Active 설정
				C_MENU.setMenuActive(C_MENU.mainMenuList, idx);

				var rparm = {
					 targetId 		: "mainMenuList"
					,list			: C_MENU.mainMenuList
				}
				C_COM.renderHtml("header", rparm);
			 }
			,setSubMenuList	 : function(mainMenuIdx) {
				let PARENT_MENU_ID = C_MENU.mainMenuList[mainMenuIdx].MENU_ID;
				
				let subMenuList = C_MENU.subMenuListMap[PARENT_MENU_ID];
				
				C_MENU.subMenuList = subMenuList;
				
				return subMenuList;
			 }
			,showSubMenuList : function(mainMenuIdx, subMenuIdx) {

				let subMenuList = C_MENU.setSubMenuList(mainMenuIdx);
				
				let PARENT_MENU_NM = subMenuList[subMenuIdx].PARENT_MENU_NM;
				
				C_MENU.setMenuActive(subMenuList, subMenuIdx);
				
				var rparm = {
					 targetId 		: "subMenuList"
					,list			: subMenuList
					,PARENT_MENU_NM	: PARENT_MENU_NM
				}
				C_COM.renderHtml("mainContainer", rparm);
			 }
			,moveMainMenu 	: function(mainMenuIdx) {
				C_MENU.showSubMenuList(mainMenuIdx, 0);
				C_MENU.moveSubMenu(0);
				if(in_array(C_MENU.mainMenuList[mainMenuIdx].MENU_ID, ["MN_SCD", "MN_FDS"])) {
					$("#subMenuList").hide();
				} else {
					$("#subMenuList").show();
				}  
				
			 }
			,moveSubMenu	: function(idx) {
				let subMenu = C_MENU.subMenuList[idx];
				let parm = {};
				if(isValid(subMenu.PARAMETER)) {
					eval(`parm = ${subMenu.PARAMETER}` );
				}
				C_PM.movePage(subMenu.PAGE_ID, parm);
			 }
			,moveMenu : function(subMenuId) {
				let mainIndex	= C_MENU.allMenuMap[subMenuId].mainIndex;
				let subIndex	= C_MENU.allMenuMap[subMenuId].subIndex;
				
				C_MENU.showMainMenuList	(mainIndex				);
				C_MENU.moveMainMenu		(mainIndex				);
				C_MENU.showSubMenuList	(mainIndex, subIndex	);
				C_MENU.moveSubMenu		(subIndex				);
			 }
		} 
		
	</script>
	
	
	<style>
      /*# CKEditor Style 높이/Font 설정 */
        
	  .ck-editor__editable { height: 250px; }
	  .ck-content { font-size: 12px; }
	  
	  /*# 달력 관련 */
	  #calendar {
	  }
	  /*시간제목*/
	  .fc-daygrid-dot-event > .fc-event-title{
	    color:#000 !important;
	    font-size:1em;
	  }
	  /*제목*/
	  .fc-event-title.fc-sticky{
	    
	    font-size:1em;
	  }
	  /*일정시간*/
	  .fc-daygrid-event > .fc-event-time{
	    color:#000;
	    font-size:3em;
	  }
	  
	</style>

</head>
<body class="main">
	<header id="header">
		<div class="wrap">
			<h1 class="logo"><a href="#">Start Asset</a></h1>
			<nav class="gnb">
				<ul id="mainMenuList">
				</ul>
				<script type="text/x-jsrender" id="mainMenuList_template">						
				{{for list}}
					<li class="{{:activeClass}}"><a href="javascript:C_MENU.moveMainMenu({{:#index}});">{{:MENU_NM}}</a></li>
				{{/for}}
				</script>
			</nav>
			<div class="header_right">
				<div class="head-btn-wrap">
			        <button class="menu-btn">
			            <span class="line line1"></span>
			            <span class="line line2"></span>
			            <span class="line line3"></span>
			        </button>
			    </div>
				<button type="button" class="btn_arrow"></button>
				<a href="#" class="alarm">알림</a>
				<a href="#" class="user_login"><span id="loginUserNm">이희성</span></a>
				<ul class="user_menu">
					<li><a href="#"><i class="icon_admin"></i>관리자 페이지</a></li>
					<li><a href="#"><i class="icon_pwEdit"></i>비밀번호 변경</a></li>
					<li><a href="javascript:logout()"><i class="icon_logout"></i>로그아웃</a></li>
				</ul>
			</div>
		</div>
	</header>
	<div class="container" id="mainContainer">
		<nav class="lnb" id="subMenuList" style="display:none">
		</nav>
		<script type="text/x-jsrender" id="subMenuList_template">						
			<div class="lnb_tit01">{{:PARENT_MENU_NM}}<button class="btn fold"><i class="icon_arrow"></i></button></div>
			<ul>
				<li>
					<ul>
					{{for list}}
						<li class="{{:activeClass}}"><a href="javascript:C_MENU.moveSubMenu({{:#index}});">{{:MENU_NM}}</a></li>
					{{/for}}
					</ul>
				</li>
			</ul>
		</script>
		<span id="bodyBlock">
		</span>


		<span id="footerBlock">
		</span>



		
		<!--  각종 Template 111 -->
		
		<!--  
			Multibox Template
			
			
			 
		-->
		<script type="text/x-jsrender" id="_comMultibox_template">	
			<button type="button" class="btn arrow" uid="{{:targetId}}">
				<span class="hida" uid="{{:targetId}}">선택</span>
				<p class="multiSel" uid="{{:targetId}}"></p>
			</button>
		    <div class="mutliSelect" uid="{{:targetId}}">
		        <ul uid="{{:targetId}}" id="{{:targetId}}_ul">
				{{for list ~targetId=targetId}}
		            <li uid="{{:targetId}}">
		                <input uid="{{:targetId}}" type="checkbox" nametext="{{:NM}}" value="{{:CD}}" id="mutli{{:~targetId}}{{:#index}}" onClick="C_UICOM.clickMultiBox('{{:~targetId}}')"><label uid="{{:targetId}}" for="mutli{{:~targetId}}{{:#index}}">{{:NM}}</label>
		    		</li>
				{{/for}}
		        </ul>
		    </div>
		</script>
				
		<script type="text/x-jsrender" id="_comSinglebox_template">	
			<button type="button" class="btn radio" onclick="C_UICOM.toggleSingleSelectBox('{{:targetId}}')" uid="{{:targetId}}"><span uid="{{:targetId}}">{{:firstItemNm}}</span></button>
            <ul class="select_lst viewHide" id="{{:targetId}}_ul" uid="{{:targetId}}">
				{{for list ~targetId=targetId}}
                <li uid="{{:targetId}}">
                    <input uid="{{:targetId}}" id="single{{:~targetId}}{{:#index}}" type="radio" value="{{:CD}}" onclick="C_UICOM.setSingleBox('{{:~targetId}}', '{{:CD}}')">
                    <label uid="{{:targetId}}" for="single{{:~targetId}}{{:#index}}">{{:NM}}<i class="icon_check"></i></label>
                </li>
				{{/for}}
            </ul>
		</script>

	</div>
</body>
</html>